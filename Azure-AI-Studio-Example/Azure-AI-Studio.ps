import openai
import os

# Set up your credentials here
API_KEY = "YOUR_AZURE_OPENAI_API_KEY"
ENDPOINT = "https://YOUR_RESOURCE_NAME.openai.azure.com/"
DEPLOYMENT_NAME = "phi3.5-small"  # Using the phi3.5 small model

# Set up API key and endpoint for Azure
openai.api_key = API_KEY
openai.api_base = ENDPOINT

# Define Azure OpenAI API version
openai.api_version = "2023-05-15"  # You may need to change this to the version you are using.

# Define the headers for Azure authentication
openai.api_type = "azure"

def send_query_to_azure(prompt: str):
    try:
        # Call the Azure OpenAI API
        response = openai.Completion.create(
            engine=DEPLOYMENT_NAME,  # Use your model deployment name
            prompt=prompt,
            max_tokens=150,
            temperature=0.7
        )

        # Extracting response text
        result_text = response.choices[0].text.strip()
        return result_text
    except Exception as e:
        return f"Error occurred: {str(e)}"

if __name__ == "__main__":
    # Define your prompt
    user_query = "What is the capital of France?"

    # Send the query and get the response
    response = send_query_to_azure(user_query)
    print(f"Response from Azure AI Studio: {response}")
